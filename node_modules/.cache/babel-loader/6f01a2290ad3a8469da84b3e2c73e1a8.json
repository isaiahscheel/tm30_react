{"ast":null,"code":"\"use strict\";\n\nfunction interp1d(arr, x) {\n  var ix = Math.floor(x),\n      fx = x - ix,\n      s0 = 0 <= ix && ix < arr.shape[0],\n      s1 = 0 <= ix + 1 && ix + 1 < arr.shape[0],\n      w0 = s0 ? +arr.get(ix) : 0.0,\n      w1 = s1 ? +arr.get(ix + 1) : 0.0;\n  return (1.0 - fx) * w0 + fx * w1;\n}\n\nfunction interp2d(arr, x, y) {\n  var ix = Math.floor(x),\n      fx = x - ix,\n      s0 = 0 <= ix && ix < arr.shape[0],\n      s1 = 0 <= ix + 1 && ix + 1 < arr.shape[0],\n      iy = Math.floor(y),\n      fy = y - iy,\n      t0 = 0 <= iy && iy < arr.shape[1],\n      t1 = 0 <= iy + 1 && iy + 1 < arr.shape[1],\n      w00 = s0 && t0 ? arr.get(ix, iy) : 0.0,\n      w01 = s0 && t1 ? arr.get(ix, iy + 1) : 0.0,\n      w10 = s1 && t0 ? arr.get(ix + 1, iy) : 0.0,\n      w11 = s1 && t1 ? arr.get(ix + 1, iy + 1) : 0.0;\n  return (1.0 - fy) * ((1.0 - fx) * w00 + fx * w10) + fy * ((1.0 - fx) * w01 + fx * w11);\n}\n\nfunction interp3d(arr, x, y, z) {\n  var ix = Math.floor(x),\n      fx = x - ix,\n      s0 = 0 <= ix && ix < arr.shape[0],\n      s1 = 0 <= ix + 1 && ix + 1 < arr.shape[0],\n      iy = Math.floor(y),\n      fy = y - iy,\n      t0 = 0 <= iy && iy < arr.shape[1],\n      t1 = 0 <= iy + 1 && iy + 1 < arr.shape[1],\n      iz = Math.floor(z),\n      fz = z - iz,\n      u0 = 0 <= iz && iz < arr.shape[2],\n      u1 = 0 <= iz + 1 && iz + 1 < arr.shape[2],\n      w000 = s0 && t0 && u0 ? arr.get(ix, iy, iz) : 0.0,\n      w010 = s0 && t1 && u0 ? arr.get(ix, iy + 1, iz) : 0.0,\n      w100 = s1 && t0 && u0 ? arr.get(ix + 1, iy, iz) : 0.0,\n      w110 = s1 && t1 && u0 ? arr.get(ix + 1, iy + 1, iz) : 0.0,\n      w001 = s0 && t0 && u1 ? arr.get(ix, iy, iz + 1) : 0.0,\n      w011 = s0 && t1 && u1 ? arr.get(ix, iy + 1, iz + 1) : 0.0,\n      w101 = s1 && t0 && u1 ? arr.get(ix + 1, iy, iz + 1) : 0.0,\n      w111 = s1 && t1 && u1 ? arr.get(ix + 1, iy + 1, iz + 1) : 0.0;\n  return (1.0 - fz) * ((1.0 - fy) * ((1.0 - fx) * w000 + fx * w100) + fy * ((1.0 - fx) * w010 + fx * w110)) + fz * ((1.0 - fy) * ((1.0 - fx) * w001 + fx * w101) + fy * ((1.0 - fx) * w011 + fx * w111));\n}\n\nfunction interpNd(arr) {\n  var d = arr.shape.length | 0,\n      ix = new Array(d),\n      fx = new Array(d),\n      s0 = new Array(d),\n      s1 = new Array(d),\n      i,\n      t;\n\n  for (i = 0; i < d; ++i) {\n    t = +arguments[i + 1];\n    ix[i] = Math.floor(t);\n    fx[i] = t - ix[i];\n    s0[i] = 0 <= ix[i] && ix[i] < arr.shape[i];\n    s1[i] = 0 <= ix[i] + 1 && ix[i] + 1 < arr.shape[i];\n  }\n\n  var r = 0.0,\n      j,\n      w,\n      idx;\n\n  i_loop: for (i = 0; i < 1 << d; ++i) {\n    w = 1.0;\n    idx = arr.offset;\n\n    for (j = 0; j < d; ++j) {\n      if (i & 1 << j) {\n        if (!s1[j]) {\n          continue i_loop;\n        }\n\n        w *= fx[j];\n        idx += arr.stride[j] * (ix[j] + 1);\n      } else {\n        if (!s0[j]) {\n          continue i_loop;\n        }\n\n        w *= 1.0 - fx[j];\n        idx += arr.stride[j] * ix[j];\n      }\n    }\n\n    r += w * arr.data[idx];\n  }\n\n  return r;\n}\n\nfunction interpolate(arr, x, y, z) {\n  switch (arr.shape.length) {\n    case 0:\n      return 0.0;\n\n    case 1:\n      return interp1d(arr, x);\n\n    case 2:\n      return interp2d(arr, x, y);\n\n    case 3:\n      return interp3d(arr, x, y, z);\n\n    default:\n      return interpNd.apply(undefined, arguments);\n  }\n}\n\nmodule.exports = interpolate;\nmodule.exports.d1 = interp1d;\nmodule.exports.d2 = interp2d;\nmodule.exports.d3 = interp3d;","map":null,"metadata":{},"sourceType":"script"}