{"ast":null,"code":"\"use strict\";\n\nmodule.exports = permutationSign;\nvar BRUTE_FORCE_CUTOFF = 32;\n\nvar pool = require(\"typedarray-pool\");\n\nfunction permutationSign(p) {\n  var n = p.length;\n\n  if (n < BRUTE_FORCE_CUTOFF) {\n    //Use quadratic algorithm for small n\n    var sgn = 1;\n\n    for (var i = 0; i < n; ++i) {\n      for (var j = 0; j < i; ++j) {\n        if (p[i] < p[j]) {\n          sgn = -sgn;\n        } else if (p[i] === p[j]) {\n          return 0;\n        }\n      }\n    }\n\n    return sgn;\n  } else {\n    //Otherwise use linear time algorithm\n    var visited = pool.mallocUint8(n);\n\n    for (var i = 0; i < n; ++i) {\n      visited[i] = 0;\n    }\n\n    var sgn = 1;\n\n    for (var i = 0; i < n; ++i) {\n      if (!visited[i]) {\n        var count = 1;\n        visited[i] = 1;\n\n        for (var j = p[i]; j !== i; j = p[j]) {\n          if (visited[j]) {\n            pool.freeUint8(visited);\n            return 0;\n          }\n\n          count += 1;\n          visited[j] = 1;\n        }\n\n        if (!(count & 1)) {\n          sgn = -sgn;\n        }\n      }\n    }\n\n    pool.freeUint8(visited);\n    return sgn;\n  }\n}","map":null,"metadata":{},"sourceType":"script"}